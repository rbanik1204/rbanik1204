name: ğŸ GitHub Snake Contribution Animation

on:
  schedule:
    # Multiple times per day for fresh animations
    - cron: "0 0 * * *"      # Daily at midnight UTC
    - cron: "0 12 * * *"     # Daily at noon UTC
    - cron: "0 18 * * *"     # Daily at 6 PM UTC
  workflow_dispatch:           # Manual trigger
  push:
    branches:
      - main
      - master
  pull_request:
    branches:
      - main
      - master

env:
  GITHUB_USER: rbanik1204
  SNAKE_OUTPUT_DIR: ./output

jobs:
  generate-snake:
    runs-on: ubuntu-latest
    timeout-minutes: 15
    strategy:
      matrix:
        include:
          # Matrix for different snake styles and themes
          - name: "Classic Snake"
            output: "github-snake.svg"
            palette: "github"
            color_snake: "#00ff00"
            color_dots: "#1b1f23,#21262d,#30363d,#484f58,#656d76"
          
          - name: "Dark Theme Snake"
            output: "github-snake-dark.svg"
            palette: "github-dark"
            color_snake: "#61dafb"
            color_dots: "#0d1117,#161b22,#21262d,#30363d,#484f58"
          
          - name: "Ocean Theme Snake"
            output: "github-snake-ocean.svg"
            palette: "github-dark"
            color_snake: "#00d4ff"
            color_dots: "#001f3f,#003366,#004080,#0056b3,#0066cc"
          
          - name: "Sunset Theme Snake"
            output: "github-snake-sunset.svg"
            palette: "github-dark"
            color_snake: "#ff6b35"
            color_dots: "#2c1810,#4a2c1a,#6b3f24,#8c522e,#ad6538"
          
          - name: "Neon Theme Snake"
            output: "github-snake-neon.svg"
            palette: "github-dark"
            color_snake: "#ff00ff"
            color_dots: "#1a0033,#330066,#4d0099,#6600cc,#8000ff"
          
          - name: "Forest Theme Snake"
            output: "github-snake-forest.svg"
            palette: "github-dark"
            color_snake: "#00ff88"
            color_dots: "#0d2b1a,#1a4d33,#266f4d,#339166,#40b380"

    steps:
      # Step 1: Checkout Repository
      - name: ğŸš€ Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      # Step 2: Setup Node.js for additional processing
      - name: ğŸ“¦ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      # Step 3: Generate Multiple Snake Animations
      - name: ğŸ Generate ${{ matrix.name }}
        uses: Platane/snk@v3
        with:
          github_user_name: ${{ env.GITHUB_USER }}
          outputs: |
            ${{ env.SNAKE_OUTPUT_DIR }}/${{ matrix.output }}?palette=${{ matrix.palette }}&color_snake=${{ matrix.color_snake }}&color_dots=${{ matrix.color_dots }}
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      # Step 4: Generate Animated GIF Version
      - name: ğŸ¬ Generate Animated GIF
        uses: Platane/snk@v3
        with:
          github_user_name: ${{ env.GITHUB_USER }}
          outputs: |
            ${{ env.SNAKE_OUTPUT_DIR }}/github-snake-animated.gif?color_snake=${{ matrix.color_snake }}&color_dots=${{ matrix.color_dots }}&animation=true
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      # Step 5: Generate Special Effects Versions
      - name: âœ¨ Generate Glow Effect Snake
        uses: Platane/snk@v3
        with:
          github_user_name: ${{ env.GITHUB_USER }}
          outputs: |
            ${{ env.SNAKE_OUTPUT_DIR }}/github-snake-glow.svg?palette=${{ matrix.palette }}&color_snake=${{ matrix.color_snake }}&color_dots=${{ matrix.color_dots }}&glow=true
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

  # Additional job for creating a comprehensive snake showcase
  create-showcase:
    runs-on: ubuntu-latest
    needs: generate-snake
    timeout-minutes: 10
    
    steps:
      - name: ğŸš€ Checkout Repository
        uses: actions/checkout@v4

      - name: ğŸ“¦ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      - name: ğŸ”§ Create Snake Showcase HTML
        run: |
          cat > ${{ env.SNAKE_OUTPUT_DIR }}/snake-showcase.html << 'EOF'
          <!DOCTYPE html>
          <html lang="en">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>ğŸ GitHub Snake Showcase - ${{ env.GITHUB_USER }}</title>
              <style>
                  body { 
                      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
                      background: linear-gradient(135deg, #0d1117 0%, #161b22 100%);
                      color: #f0f6fc; 
                      margin: 0; 
                      padding: 20px; 
                  }
                  .container { max-width: 1200px; margin: 0 auto; }
                  h1 { text-align: center; color: #58a6ff; margin-bottom: 30px; }
                  .snake-grid { 
                      display: grid; 
                      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); 
                      gap: 20px; 
                      margin-bottom: 30px; 
                  }
                  .snake-item { 
                      background: rgba(255,255,255,0.05); 
                      border-radius: 10px; 
                      padding: 20px; 
                      text-align: center; 
                      border: 1px solid rgba(255,255,255,0.1);
                      transition: transform 0.3s ease;
                  }
                  .snake-item:hover { transform: translateY(-5px); }
                  .snake-item h3 { color: #58a6ff; margin-bottom: 15px; }
                  .snake-item img { max-width: 100%; height: auto; border-radius: 5px; }
                  .stats { 
                      background: rgba(255,255,255,0.05); 
                      border-radius: 10px; 
                      padding: 20px; 
                      margin-top: 20px; 
                      text-align: center; 
                  }
                  .footer { text-align: center; margin-top: 30px; opacity: 0.7; }
              </style>
          </head>
          <body>
              <div class="container">
                  <h1>ğŸ GitHub Snake Contribution Showcase</h1>
                  <div class="snake-grid">
                      <div class="snake-item">
                          <h3>ğŸŒ™ Dark Theme</h3>
                          <img src="github-snake-dark.svg" alt="Dark Theme Snake">
                      </div>
                      <div class="snake-item">
                          <h3>ğŸŒŠ Ocean Theme</h3>
                          <img src="github-snake-ocean.svg" alt="Ocean Theme Snake">
                      </div>
                      <div class="snake-item">
                          <h3>ğŸŒ… Sunset Theme</h3>
                          <img src="github-snake-sunset.svg" alt="Sunset Theme Snake">
                      </div>
                      <div class="snake-item">
                          <h3>ğŸ’« Neon Theme</h3>
                          <img src="github-snake-neon.svg" alt="Neon Theme Snake">
                      </div>
                      <div class="snake-item">
                          <h3>ğŸŒ² Forest Theme</h3>
                          <img src="github-snake-forest.svg" alt="Forest Theme Snake">
                      </div>
                      <div class="snake-item">
                          <h3>ğŸ¬ Animated GIF</h3>
                          <img src="github-snake-animated.gif" alt="Animated Snake">
                      </div>
                  </div>
                  <div class="stats">
                      <h3>ğŸ“Š Contribution Statistics</h3>
                      <p>Generated on: $(date)</p>
                      <p>Total themes: 6</p>
                      <p>Update frequency: 3x daily</p>
                  </div>
                  <div class="footer">
                      <p>Powered by GitHub Actions & Platane/snk</p>
                      <p>Profile: <a href="https://github.com/${{ env.GITHUB_USER }}" style="color: #58a6ff;">@${{ env.GITHUB_USER }}</a></p>
                  </div>
              </div>
          </body>
          </html>
          EOF

      - name: ğŸ“ Create README for Snake Outputs
        run: |
          cat > ${{ env.SNAKE_OUTPUT_DIR }}/README.md << 'EOF'
          # ğŸ GitHub Snake Contribution Animations
          
          This directory contains various themed GitHub snake contribution animations for **${{ env.GITHUB_USER }}**.
          
          ## ğŸ¨ Available Themes
          
          | Theme | File | Description |
          |-------|------|-------------|
          | ğŸŒ™ Dark | `github-snake-dark.svg` | Modern dark theme with blue accents |
          | ğŸŒŠ Ocean | `github-snake-ocean.svg` | Deep ocean blue color scheme |
          | ğŸŒ… Sunset | `github-snake-sunset.svg` | Warm sunset orange tones |
          | ğŸ’« Neon | `github-snake-neon.svg` | Vibrant neon purple theme |
          | ğŸŒ² Forest | `github-snake-forest.svg` | Natural forest green palette |
          | ğŸ¬ Animated | `github-snake-animated.gif` | Animated GIF version |
          | âœ¨ Glow | `github-snake-glow.svg` | Glowing effect version |
          
          ## ğŸš€ Usage
          
          ### In README.md
          ```markdown
          ## ğŸ GitHub Snake Contribution Animation
          
          ![GitHub Snake](https://raw.githubusercontent.com/${{ env.GITHUB_USER }}/${{ env.GITHUB_USER }}/output/github-snake-dark.svg)
          ```
          
          ### In HTML
          ```html
          <img src="https://raw.githubusercontent.com/${{ env.GITHUB_USER }}/${{ env.GITHUB_USER }}/output/github-snake-dark.svg" alt="GitHub Snake">
          ```
          
          ## âš™ï¸ Auto-Update
          
          - **Schedule**: Updates 3 times daily (midnight, noon, 6 PM UTC)
          - **Trigger**: Also updates on push to main/master branch
          - **Manual**: Can be triggered manually via GitHub Actions
          
          ## ğŸ¯ Customization
          
          Each theme uses different color palettes:
          - **Snake Color**: The main contribution trail color
          - **Dot Colors**: 5-level contribution intensity colors
          - **Palette**: Overall theme (github or github-dark)
          
          ---
          
          *Generated automatically by GitHub Actions*
          EOF

  # Deploy all outputs
  deploy:
    runs-on: ubuntu-latest
    needs: [generate-snake, create-showcase]
    timeout-minutes: 10
    
    steps:
      - name: ğŸš€ Checkout Repository
        uses: actions/checkout@v4

      - name: ğŸ“¤ Deploy to Output Branch
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./output
          publish_branch: output
          commit_message: "ğŸ Update snake animations [skip ci] - $(date)"
          force_orphan: true

      - name: ğŸ‰ Success Notification
        run: |
          echo "âœ… All snake animations generated and deployed successfully!"
          echo "ğŸŒ View at: https://${{ env.GITHUB_USER }}.github.io/${{ env.GITHUB_USER }}/"
          echo "ğŸ“ Output files: https://github.com/${{ env.GITHUB_USER }}/${{ env.GITHUB_USER }}/tree/output"
